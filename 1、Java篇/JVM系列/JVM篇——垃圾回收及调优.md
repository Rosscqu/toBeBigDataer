## JVM篇——垃圾回收及调优



### 1、判断对象是否存活的方法

#### 1.1 引用计数



缺点：如果对象之间相互引用，那么对象无法清除，即产生内存泄漏；

#### 1.2 可达性分析



可以作为GC roots的对象：

- 当前正在执行的方法的局部变量和输入参数；
- 活动线程
- 所有类的静态字段
- JNI引用



### 2、垃圾清除方法

#### 2.1 标记-清除算法

标记：遍历所有的可达对象，并在本地内存中分门别类记下；

清除：清除不可达对象所占用的内存，在之后进行内存分配时可以重用。



#### 2.2 标记-复制算法



#### 2.3 标记-整理算法





### 3、分代理论



分代假说：

- 大部分新生对象很快无用；
- 存活较长时间的对象，可能存活更长的时间



基于分代假说，将堆内存划分为新生代和老年代，其中新生代划分为Eden区、S0区、S1区。针对不同类型对象不同区域，采用不同策略进行处理。



#### 3.1 Eden区

对象分配是在Eden区，标记阶段Eden区存活的对象就会复制到存活区。存活时间超过一定YGC后（默认15次）后，就会将对象移动到老年代。



#### 3.2 老年代

老年代默认都是存活对象，采用复制-整理的方法：

标记所有通过GC Root可达的对象；

删除所有不可达对象；

整理老年代空间中的内容，方法是将所有存活对象复制，从老年代空间开始的地方依次存放。

默认情况下：Eden:S0:S1=8:1:1



### 4、垃圾收集器







